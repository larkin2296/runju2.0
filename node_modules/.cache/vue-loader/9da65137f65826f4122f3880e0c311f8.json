{"remainingRequest":"/Library/WebServer/Documents/runju2.0/node_modules/vue-loader/lib/index.js??vue-loader-options!/Library/WebServer/Documents/runju2.0/src/views/mappage/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Library/WebServer/Documents/runju2.0/src/views/mappage/index.vue","mtime":1543894136816},{"path":"/Library/WebServer/Documents/runju2.0/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/runju2.0/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/runju2.0/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/runju2.0/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { TMap } from '../../TMap.js';\nimport { search_map_house,get_house_search } from '@/api/house.js'\nimport { NavBar,Search,Loading,Popup,NoticeBar,Icon } from 'vant'\nimport Child from '../../components/Keyword.vue'\nexport default {\n    data(){\n        return{\n            markers: [],\n            value: '',\n            top_left: [],\n            top_right: [],\n            bottom_left: [],\n            bottom_right: [],\n            region: [],\n            show_loading: 1,\n            list: [],\n            show:false,\n            show1:false,\n            msg: ''\n        }\n    },\n    created(){\n        this.fetchData('')\n    },\n    components:{\n        Child,\n        [NavBar.name]:NavBar,\n        [Search.name]:Search,\n        [Loading.name]:Loading,\n        [Popup.name]:Popup,\n        [NoticeBar.name]:NoticeBar,\n        [Icon.name]:Icon\n    },\n    methods:{\n        onClickLeft(){\n            this.$router.push({path: '/'})\n        },\n        onSearch(){\n            this.show_loading = 0\n            var that = this\n            var param = Object()\n            param.search = this.value\n            this.get_search_area(this.value).then(val=>{\n                search_map_house(param).then(res=>{\n                if(res.code == '2000'){\n                    var i = 0\n                    this.markers = []\n                    var interval = setInterval(function(){\n                        that._Tmap(res.data[i][0],res.data[i][1],that.region)\n                        i++\n                        if(i == res.data.length){\n                            clearInterval(interval)\n                            that.show_loading = 1\n                        }\n                    },500)\n                    //that._Tmap('浦东新区乳山四村')\n                }else if(res.code == '3000'){\n                    this.msg = '没有搜索到结果'\n                    this.show = true\n                    setTimeout(function () {\n                        that.show = false\n                    }, 1500) \n                    this.show_loading = 1\n                    this.fetchData('')   \n                }\n                })\n            })\n        },\n        fetchData(data){\n            this._Tmap(data)\n        },\n        get_search_area(data){\n            var that = this\n            TMap('TEFBZ-LI5KD-AEE4S-HLTQ3-74SJ7-UJB6G').then(qq => {\n                //调用Poi检索类\n                var searchService = new qq.maps.SearchService({\n                    //检索成功的回调函数\n                    complete: function(results) {\n                        var pois = results.detail.pois;\n                        var lat = pois[0].latLng.lat\n                        var lng = pois[0].latLng.lng\n                        var new_lat_left = Number(lat) - Number(0.02000)\n                        var new_lat_right = Number(lat) + Number(0.02000)\n                        var new_lng_left = Number(lng) - Number(0.020000)\n                        var new_lng_right = Number(lng) + Number(0.020000)\n                        that.top_left = new qq.maps.LatLng(new_lat_left,new_lng_left)\n                        that.top_right = new qq.maps.LatLng(new_lat_right,new_lng_left)\n                        that.bottom_left = new qq.maps.LatLng(new_lat_left,new_lng_right)\n                        that.bottom_right = new qq.maps.LatLng(new_lat_right,new_lng_right)\n                        that.region = new qq.maps.LatLngBounds(that.top_left,that.bottom_right);\n                        },\n                        //若服务请求失败，则运行以下函数\n                        error: function() {\n                        }\n                });\n                searchService.setPageIndex(1);\n                    //设置每页的结果数\n                searchService.setPageCapacity(1);\n                searchService.setLocation('上海');\n                searchService.search(data);\n            });\n            return Promise.resolve(that.region)\n        },\n        _Tmap(data1,data2,region){\n            TMap('TEFBZ-LI5KD-AEE4S-HLTQ3-74SJ7-UJB6G').then(qq => {\n            var map = new qq.maps.Map(document.getElementById(\"container\"), {\n                // 地图的中心地理坐标。\n                center: new qq.maps.LatLng(31.23595,121.480524),\n                 zoom: 11,\n                 disableDefaultUI: true,\n                 zoomControl: true, \n            });\n            var that = this\n            //调用Poi检索类\n            var searchService = new qq.maps.SearchService({\n                //检索成功的回调函数\n                complete: function(results) {\n                    console.log(results)\n                    var pois = results.detail.pois;\n                    var marker = new qq.maps.Label({\n                        content: data2,\n                    });\n                    //console.log(pois[0].latLng)\n                    marker.setPosition(pois[0].latLng);\n                    that.markers.push(marker);\n                    //console.log(that.markers)\n                    var latlngBounds = new qq.maps.LatLngBounds();\n                    for(var i = 0, l = that.markers.length; i < l; i++){\n                            var cssC={color:\"#EA8608\",fontSize:\"12px\",fontWeight:\"normal\"};\n                            latlngBounds.extend(that.markers[i].position);\n                            (function(n) {\n                            var marker = new qq.maps.Label({\n                                position: new qq.maps.LatLng(that.markers[i].position.lat, that.markers[i].position.lng),\n                                map: map,\n                                content: that.markers[i].content,\n                                style:cssC\n                            });\n                            //marker.setStyle(cssC);\n                            qq.maps.event.addListener(marker, 'click', function() {\n                                var param = Object()\n                                param.name = marker.content\n                                get_house_search(param).then(res=>{\n                                    that.show1 = true\n                                    that.list = res.data\n                                })\n                            });\n                        })(i);                      \n                    }\n\n\n                //     //设置回调函数参数\n                //     var pois = results.detail.pois;\n                //     var infoWin = new qq.maps.InfoWindow({\n                //         map: map\n                //     });\n                //     var latlngBounds = new qq.maps.LatLngBounds();\n                //     for (var i = 0, l = pois.length; i < l; i++) {\n                //         var poi = pois[i];\n                //         //扩展边界范围，用来包含搜索到的Poi点\n                //         latlngBounds.extend(poi.latLng);\n        \n                //         (function(n) {\n                //             var marker = new qq.maps.Marker({\n                //                 map: map\n                //             });\n                //             marker.setPosition(pois[n].latLng);\n        \n                //             marker.setTitle(i + 1);\n                //             that.markers.push(marker);\n                //             console.log(that.markers)\n        \n                //             // qq.maps.event.addListener(marker, 'click', function() {\n                //             //     infoWin.open();\n                //             //     infoWin.setContent('<div style=\"width:280px;height:100px;\">' + 'POI的ID为：' +\n                //             //         pois[n].id + '，POI的名称为：' + pois[n].name + '，POI的地址为：' + pois[n].address + '，POI的类型为：' + pois[n].type + '</div>');\n                //             //     infoWin.setPosition(pois[n].latLng);\n                //             // });\n                //         })(i);\n                //     }\n                // //调整地图视野\n                     map.fitBounds(latlngBounds);\n                    },\n                    //若服务请求失败，则运行以下函数\n                    error: function() {\n                        \n                    }\n            });\n            searchService.setPageIndex(1);\n                //设置每页的结果数\n            searchService.setPageCapacity(1);\n            searchService.setLocation('上海');\n            if(data1 != '' && data2 != ''){\n                searchService.searchInBounds((data1+data2), region)\n            }\n        });\n        },\n        goDetail(id){\n        this.$router.push({name:'detail',params: { id: id,type: 1 }})\n        },\n    }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/mappage","sourcesContent":["<template>\n    <div id='page'>\n        <van-nav-bar\n        title=\"地图找房\"\n        left-text=\"返回\"\n        right-text=\"\"\n        left-arrow\n        @click-left=\"onClickLeft\"\n        />\n        <van-popup class='msg' v-model=\"show\" :overlay=\"false\"><van-icon name='question'/>{{msg}}</van-popup>\n        <van-search\n        v-model=\"value\"\n        placeholder=\"请输入搜索小区名或地铁站名\"\n        show-action\n        @search=\"onSearch\"\n        >\n        <div slot=\"action\" @click=\"onSearch\">搜索</div>\n        </van-search>\n        <van-loading v-if='show_loading == 0' color=\"white\" />\n        <div v-if='show_loading == 1' id='container'>\n\n        </div>\n        <van-popup v-model=\"show1\" position=\"bottom\" :overlay=\"true\" :close-on-click-overlay=\"true\">\n        <div v-for=\"(item,index) in list\" :key=\"index\" class='house' @click=\"goDetail(item.id)\">\n            <div class='house_detail'>\n                <div class='swipe_left'><img :src=\"item.pic_1\" /></div>\n                <div class='swipe_right'>\n                <div class='swipe_right_top'><van-notice-bar :text=\"item.title\" background='#ffffff'/></div>\n                <div class='swipe_right_center'>{{item.door_name}} 大一居大床外景</div>\n                <div class='swipe_right_middle'>{{item.address}}</div>\n                <div class='swipe_right_bottom'>\n                    <child v-for=\"(itemchild,index) in item.key_name\" :key=\"index\" :message=\"itemchild\"></child>\n                </div>\n                <div class='swipe_right_price'>{{item.price}}元/月</div>\n                </div>\n            </div>\n        </div>\n        </van-popup>\n    </div>\n</template>\n\n<script>\nimport { TMap } from '../../TMap.js';\nimport { search_map_house,get_house_search } from '@/api/house.js'\nimport { NavBar,Search,Loading,Popup,NoticeBar,Icon } from 'vant'\nimport Child from '../../components/Keyword.vue'\nexport default {\n    data(){\n        return{\n            markers: [],\n            value: '',\n            top_left: [],\n            top_right: [],\n            bottom_left: [],\n            bottom_right: [],\n            region: [],\n            show_loading: 1,\n            list: [],\n            show:false,\n            show1:false,\n            msg: ''\n        }\n    },\n    created(){\n        this.fetchData('')\n    },\n    components:{\n        Child,\n        [NavBar.name]:NavBar,\n        [Search.name]:Search,\n        [Loading.name]:Loading,\n        [Popup.name]:Popup,\n        [NoticeBar.name]:NoticeBar,\n        [Icon.name]:Icon\n    },\n    methods:{\n        onClickLeft(){\n            this.$router.push({path: '/'})\n        },\n        onSearch(){\n            this.show_loading = 0\n            var that = this\n            var param = Object()\n            param.search = this.value\n            this.get_search_area(this.value).then(val=>{\n                search_map_house(param).then(res=>{\n                if(res.code == '2000'){\n                    var i = 0\n                    this.markers = []\n                    var interval = setInterval(function(){\n                        that._Tmap(res.data[i][0],res.data[i][1],that.region)\n                        i++\n                        if(i == res.data.length){\n                            clearInterval(interval)\n                            that.show_loading = 1\n                        }\n                    },500)\n                    //that._Tmap('浦东新区乳山四村')\n                }else if(res.code == '3000'){\n                    this.msg = '没有搜索到结果'\n                    this.show = true\n                    setTimeout(function () {\n                        that.show = false\n                    }, 1500) \n                    this.show_loading = 1\n                    this.fetchData('')   \n                }\n                })\n            })\n        },\n        fetchData(data){\n            this._Tmap(data)\n        },\n        get_search_area(data){\n            var that = this\n            TMap('TEFBZ-LI5KD-AEE4S-HLTQ3-74SJ7-UJB6G').then(qq => {\n                //调用Poi检索类\n                var searchService = new qq.maps.SearchService({\n                    //检索成功的回调函数\n                    complete: function(results) {\n                        var pois = results.detail.pois;\n                        var lat = pois[0].latLng.lat\n                        var lng = pois[0].latLng.lng\n                        var new_lat_left = Number(lat) - Number(0.02000)\n                        var new_lat_right = Number(lat) + Number(0.02000)\n                        var new_lng_left = Number(lng) - Number(0.020000)\n                        var new_lng_right = Number(lng) + Number(0.020000)\n                        that.top_left = new qq.maps.LatLng(new_lat_left,new_lng_left)\n                        that.top_right = new qq.maps.LatLng(new_lat_right,new_lng_left)\n                        that.bottom_left = new qq.maps.LatLng(new_lat_left,new_lng_right)\n                        that.bottom_right = new qq.maps.LatLng(new_lat_right,new_lng_right)\n                        that.region = new qq.maps.LatLngBounds(that.top_left,that.bottom_right);\n                        },\n                        //若服务请求失败，则运行以下函数\n                        error: function() {\n                        }\n                });\n                searchService.setPageIndex(1);\n                    //设置每页的结果数\n                searchService.setPageCapacity(1);\n                searchService.setLocation('上海');\n                searchService.search(data);\n            });\n            return Promise.resolve(that.region)\n        },\n        _Tmap(data1,data2,region){\n            TMap('TEFBZ-LI5KD-AEE4S-HLTQ3-74SJ7-UJB6G').then(qq => {\n            var map = new qq.maps.Map(document.getElementById(\"container\"), {\n                // 地图的中心地理坐标。\n                center: new qq.maps.LatLng(31.23595,121.480524),\n                 zoom: 11,\n                 disableDefaultUI: true,\n                 zoomControl: true, \n            });\n            var that = this\n            //调用Poi检索类\n            var searchService = new qq.maps.SearchService({\n                //检索成功的回调函数\n                complete: function(results) {\n                    console.log(results)\n                    var pois = results.detail.pois;\n                    var marker = new qq.maps.Label({\n                        content: data2,\n                    });\n                    //console.log(pois[0].latLng)\n                    marker.setPosition(pois[0].latLng);\n                    that.markers.push(marker);\n                    //console.log(that.markers)\n                    var latlngBounds = new qq.maps.LatLngBounds();\n                    for(var i = 0, l = that.markers.length; i < l; i++){\n                            var cssC={color:\"#EA8608\",fontSize:\"12px\",fontWeight:\"normal\"};\n                            latlngBounds.extend(that.markers[i].position);\n                            (function(n) {\n                            var marker = new qq.maps.Label({\n                                position: new qq.maps.LatLng(that.markers[i].position.lat, that.markers[i].position.lng),\n                                map: map,\n                                content: that.markers[i].content,\n                                style:cssC\n                            });\n                            //marker.setStyle(cssC);\n                            qq.maps.event.addListener(marker, 'click', function() {\n                                var param = Object()\n                                param.name = marker.content\n                                get_house_search(param).then(res=>{\n                                    that.show1 = true\n                                    that.list = res.data\n                                })\n                            });\n                        })(i);                      \n                    }\n\n\n                //     //设置回调函数参数\n                //     var pois = results.detail.pois;\n                //     var infoWin = new qq.maps.InfoWindow({\n                //         map: map\n                //     });\n                //     var latlngBounds = new qq.maps.LatLngBounds();\n                //     for (var i = 0, l = pois.length; i < l; i++) {\n                //         var poi = pois[i];\n                //         //扩展边界范围，用来包含搜索到的Poi点\n                //         latlngBounds.extend(poi.latLng);\n        \n                //         (function(n) {\n                //             var marker = new qq.maps.Marker({\n                //                 map: map\n                //             });\n                //             marker.setPosition(pois[n].latLng);\n        \n                //             marker.setTitle(i + 1);\n                //             that.markers.push(marker);\n                //             console.log(that.markers)\n        \n                //             // qq.maps.event.addListener(marker, 'click', function() {\n                //             //     infoWin.open();\n                //             //     infoWin.setContent('<div style=\"width:280px;height:100px;\">' + 'POI的ID为：' +\n                //             //         pois[n].id + '，POI的名称为：' + pois[n].name + '，POI的地址为：' + pois[n].address + '，POI的类型为：' + pois[n].type + '</div>');\n                //             //     infoWin.setPosition(pois[n].latLng);\n                //             // });\n                //         })(i);\n                //     }\n                // //调整地图视野\n                     map.fitBounds(latlngBounds);\n                    },\n                    //若服务请求失败，则运行以下函数\n                    error: function() {\n                        \n                    }\n            });\n            searchService.setPageIndex(1);\n                //设置每页的结果数\n            searchService.setPageCapacity(1);\n            searchService.setLocation('上海');\n            if(data1 != '' && data2 != ''){\n                searchService.searchInBounds((data1+data2), region)\n            }\n        });\n        },\n        goDetail(id){\n        this.$router.push({name:'detail',params: { id: id,type: 1 }})\n        },\n    }\n}\n</script>\n\n<style scoped>\n#page{\n    width:100%;\n    height:100%;\n}\n#container{\n    width:100%;\n    height:87%;\n}\n.van-loading{\n    width: 55px;\n    height: 55px;\n    font-size: 0;\n    line-height: 0;\n    position: absolute;\n    top: 50%;\n    left: 40%;\n    z-index: 999;\n    vertical-align: middle;\n    background-color: #c2c2c2;\n    border-radius: 5px;\n}\n.house{\n    width:100%;\n    height:120px;\n    background-color: #ffffff;\n}\n.house_detail{\n    width:90%;\n    margin:0 auto;\n    height:120px;\n    border-bottom: 1px solid rgb(172,172,172);\n}\n.swipe_left{\n    width: 30%;\n    height: 77%;\n    float: left;\n    margin-top: 2%;\n    border-radius: 10px;\n}\n.swipe_left img{\n  width:100%;\n  height:100%;\n  border-radius: 10px;\n}\n.swipe_right{\n  width:63%;\n  height:99%;\n  float:left;\n  margin-left:3%;\n}\n.swipe_right_top,.swipe_right_price{\n  width:100%;\n  height:25%;\n  line-height:30px;\n  font-family: PingFangLight;\n  font-size:16px;\n  color:#EA8608;\n}\n.swipe_right_center,.swipe_right_middle,.swipe_right_bottom{\n  width:100%;\n  height:16%;\n  line-height:19.2px;\n  font-family: PingFangLight;\n  font-size:13px;\n  color:rgb(172,172,172);\n  overflow: hidden;\n}\n.van-notice-bar{\n  height:30px;\n}\n.van-popup{\n    height:auto;\n    max-height:500px;\n}\n.msg{\n    width:200px;\n    height:60px;\n    text-align:center;\n    line-height:60px;\n    border-radius: 5px;\n    font-family: PingFangBold;\n    color:#ffffff;\n    font-size:15px;\n    background-color: #000000;\n    box-shadow: 3px 4px 10px 2px rgba(119,118,118,0.33);\n}\n.van-icon{\n    vertical-align: middle;\n    padding-right:5px;\n}\n</style>"]}]}