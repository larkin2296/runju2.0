{"remainingRequest":"/Library/WebServer/Documents/runju2.0/node_modules/babel-loader/lib/index.js!/Library/WebServer/Documents/runju2.0/src/permission.js","dependencies":[{"path":"/Library/WebServer/Documents/runju2.0/src/permission.js","mtime":1543672406831},{"path":"/Library/WebServer/Documents/runju2.0/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/runju2.0/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import router from './routers.js';\nimport store from './store';\nimport { getToken } from '@/utils/auth'; // 验权\n\nconst whiteList = ['/login', '/register', '/again']; // 不重定向白名单\n\nrouter.beforeEach((to, from, next) => {\n  console.log(getToken);\n\n  if (getToken()) {\n    if (to.path === '/login') {\n      next({\n        path: '/'\n      });\n    } else {\n      if (store.getters.roles.length === 0) {\n        store.dispatch('GetInfo').then(res => {// 拉取用户信息\n        }).catch(() => {\n          store.dispatch('FedLogOut').then(() => {});\n        });\n      } else {\n        next();\n      }\n    }\n  } else {\n    if (whiteList.indexOf(to.path) !== -1) {\n      next();\n    } else {\n      next('/login');\n    }\n  }\n});",{"version":3,"sources":["/Library/WebServer/Documents/runju2.0/src/permission.js"],"names":["router","store","getToken","whiteList","beforeEach","to","from","next","console","log","path","getters","roles","length","dispatch","then","res","catch","indexOf"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,cAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,QAAT,QAAyB,cAAzB,C,CAAwC;;AAExC,MAAMC,YAAY,CAAC,QAAD,EAAW,WAAX,EAAwB,QAAxB,CAAlB,C,CAAoD;;AACpDH,OAAOI,UAAP,CAAkB,CAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,KAAoB;AAClCC,UAAQC,GAAR,CAAYP,QAAZ;;AACF,MAAIA,UAAJ,EAAgB;AACd,QAAIG,GAAGK,IAAH,KAAY,QAAhB,EAA0B;AACxBH,WAAK;AAAEG,cAAM;AAAR,OAAL;AACD,KAFD,MAEO;AACL,UAAIT,MAAMU,OAAN,CAAcC,KAAd,CAAoBC,MAApB,KAA+B,CAAnC,EAAsC;AACpCZ,cAAMa,QAAN,CAAe,SAAf,EAA0BC,IAA1B,CAA+BC,OAAO,CAAE;AACvC,SADD,EACGC,KADH,CACS,MAAM;AACbhB,gBAAMa,QAAN,CAAe,WAAf,EAA4BC,IAA5B,CAAiC,MAAM,CACtC,CADD;AAED,SAJD;AAKD,OAND,MAMO;AACLR;AACD;AACF;AACF,GAdD,MAcO;AACL,QAAIJ,UAAUe,OAAV,CAAkBb,GAAGK,IAArB,MAA+B,CAAC,CAApC,EAAuC;AACrCH;AACD,KAFD,MAEO;AACLA,WAAK,QAAL;AACD;AACF;AACF,CAvBD","sourcesContent":["import router from './routers.js'\nimport store from './store'\nimport { getToken } from '@/utils/auth' // 验权\n\nconst whiteList = ['/login', '/register', '/again'] // 不重定向白名单\nrouter.beforeEach((to, from, next) => {\n    console.log(getToken)\n  if (getToken()) {\n    if (to.path === '/login') {\n      next({ path: '/' })\n    } else {\n      if (store.getters.roles.length === 0) {\n        store.dispatch('GetInfo').then(res => { // 拉取用户信息\n        }).catch(() => {\n          store.dispatch('FedLogOut').then(() => {\n          })\n        })\n      } else {\n        next()\n      }\n    }\n  } else {\n    if (whiteList.indexOf(to.path) !== -1) {\n      next()\n    } else {\n      next('/login')\n    }\n  }\n})\n\n"]}]}